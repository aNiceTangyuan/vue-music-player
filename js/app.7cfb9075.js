(function(){"use strict";var e={5661:function(e,t,a){var s=a(3751),i=a(641);function l(e,t,a,s,l,r){const o=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.Wv)(o)}var r={name:"App"},o=a(6262);const n=(0,o.A)(r,[["render",l]]);var c=n,u=a(5220),d=(a(4114),a(33));const v={id:"music-search"},h={class:"search-header"},f={class:"search-bar"},y=["placeholder"],p={key:0},m={key:1,class:"error"},g={key:3},k=["src","alt"],I={class:"detail-info detail-info-fancy"},b={class:"detail-song detail-song-fancy"},L={class:"detail-meta-row"},C={class:"detail-singer"},S={class:"detail-album"},_={class:"detail-meta-row"},E={class:"detail-time"},w={class:"detail-quality"},B={class:"detail-meta-row"},X={class:"detail-interval"},O={class:"detail-size"},M={class:"detail-kbps"},F={class:"detail-link"},Q=["href"],U={key:0},A={key:1},D={key:0,class:"detail-audio"},P=["src"],x={key:4};function T(e,t,a,l,r,o){const n=(0,i.g2)("MusicList");return(0,i.uX)(),(0,i.CE)("div",v,[(0,i.Lk)("div",h,[t[7]||(t[7]=(0,i.Lk)("h1",{class:"search-title"},"音乐搜索",-1)),(0,i.Lk)("button",{class:"fav-list-btn",onClick:t[0]||(t[0]=t=>e.$router.push("/favorite"))},"我喜欢的音乐歌单")]),(0,i.Lk)("div",f,[(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.searchType=e),class:"search-type-select"},[...t[8]||(t[8]=[(0,i.Lk)("option",{value:"word"},"歌曲名字",-1),(0,i.Lk)("option",{value:"id"},"ID/链接",-1)])],512),[[s.u1,r.searchType]]),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.searchInput=e),onKeyup:t[3]||(t[3]=(0,s.jR)((...e)=>o.handleSearchUnified&&o.handleSearchUnified(...e),["enter"])),placeholder:"word"===r.searchType?"请输入歌曲名或歌手":"请输入歌曲ID",class:"search-input"},null,40,y),[[s.Jo,r.searchInput]]),(0,i.Lk)("button",{class:"search-btn",onClick:t[4]||(t[4]=(...e)=>o.handleSearchUnified&&o.handleSearchUnified(...e))},"搜索")]),r.loading?((0,i.uX)(),(0,i.CE)("div",p,"搜索中...")):(0,i.Q3)("",!0),r.error?((0,i.uX)(),(0,i.CE)("div",m,(0,d.v_)(r.error),1)):(0,i.Q3)("",!0),r.results.length?((0,i.uX)(),(0,i.Wv)(n,{key:2,list:r.results,onGoDetail:o.handleGoDetail},null,8,["list","onGoDetail"])):(0,i.Q3)("",!0),r.resultById?((0,i.uX)(),(0,i.CE)("div",g,[(0,i.Lk)("div",{class:"detail-card detail-card-fancy",onClick:t[6]||(t[6]=e=>o.handleGoDetail(r.resultById.id))},[(0,i.Lk)("img",{src:r.resultById.cover,alt:r.resultById.song,class:"detail-cover detail-cover-fancy"},null,8,k),(0,i.Lk)("div",I,[(0,i.Lk)("div",b,(0,d.v_)(r.resultById.song),1),(0,i.Lk)("div",L,[(0,i.Lk)("span",C,"歌手："+(0,d.v_)(r.resultById.singer),1),(0,i.Lk)("span",S,"专辑："+(0,d.v_)(r.resultById.album),1)]),(0,i.Lk)("div",_,[(0,i.Lk)("span",E,"发行时间："+(0,d.v_)(r.resultById.time||"未知"),1),(0,i.Lk)("span",w,"音质："+(0,d.v_)(r.resultById.quality),1)]),(0,i.Lk)("div",B,[(0,i.Lk)("span",X,"时长："+(0,d.v_)(r.resultById.interval||"未知"),1),(0,i.Lk)("span",O,"大小："+(0,d.v_)(r.resultById.size||"未知"),1),(0,i.Lk)("span",M,"码率："+(0,d.v_)(r.resultById.kbps||"未知"),1)]),(0,i.Lk)("div",F,[(0,i.Lk)("a",{href:r.resultById.link,target:"_blank"},"网易云播放页",8,Q)]),(0,i.Lk)("button",{class:(0,d.C4)(["fav-btn fancy-fav-btn",{liked:o.isFavorite(r.resultById.id)}]),onClick:t[5]||(t[5]=(0,s.D$)(e=>o.toggleFavorite(r.resultById.id),["stop"]))},[o.isFavorite(r.resultById.id)?((0,i.uX)(),(0,i.CE)("span",U,"❤️ 已收藏")):((0,i.uX)(),(0,i.CE)("span",A,"🤍 收藏"))],2),r.resultById.url?((0,i.uX)(),(0,i.CE)("div",D,[(0,i.Lk)("audio",{src:r.resultById.url,controls:"",class:"audio-player-fancy"},null,8,P)])):(0,i.Q3)("",!0)])])])):r.loading||r.error||r.results.length||r.resultById?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",x,"暂无结果"))])}var $=a(4335);const N=$.A.create({baseURL:"https://api.vkeys.cn/v2/music/netease",timeout:5e3});function j(e,t=4){return N.get("",{params:{id:e,quality:t}})}function q(e){return N.get("",{params:{word:e}})}const J={class:"music-list"},R=["src","alt","onClick"],G=["onClick"],z={class:"song"},H={class:"singer"},K={class:"album"},V={class:"time"},W={class:"quality"},Y=["onClick"],Z={key:0},ee={key:1},te=["onClick"],ae=["src"];function se(e,t,a,l,r,o){return(0,i.uX)(),(0,i.CE)("ul",J,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.list,e=>((0,i.uX)(),(0,i.CE)("li",{key:e.id,class:"music-item"},[(0,i.Lk)("img",{src:e.cover,alt:e.song,class:"cover",onClick:t=>o.goDetail(e.id),style:{cursor:"pointer"}},null,8,R),(0,i.Lk)("div",{class:"info",onClick:t=>o.goDetail(e.id),style:{cursor:"pointer",flex:"1"}},[(0,i.Lk)("div",z,(0,d.v_)(e.song),1),(0,i.Lk)("div",H,"歌手："+(0,d.v_)(e.singer),1),(0,i.Lk)("div",K,"专辑："+(0,d.v_)(e.album),1),(0,i.Lk)("div",V,"发行时间："+(0,d.v_)(e.time||"未知"),1),(0,i.Lk)("div",W,"音质："+(0,d.v_)(e.quality),1)],8,G),(0,i.Lk)("button",{class:(0,d.C4)(["fav-btn",{liked:o.isFavorite(e.id)}]),onClick:(0,s.D$)(t=>o.toggleFavorite(e.id),["stop"])},[o.isFavorite(e.id)?((0,i.uX)(),(0,i.CE)("span",Z,"❤️")):((0,i.uX)(),(0,i.CE)("span",ee,"🤍"))],10,Y),(0,i.Lk)("button",{class:"play-btn",onClick:(0,s.D$)(t=>o.playMusic(e.id),["stop"])},"▶️",8,te),r.audioMap[e.id]?((0,i.uX)(),(0,i.CE)("audio",{key:0,src:r.audioMap[e.id],controls:"",style:{width:"120px","margin-left":"8px","vertical-align":"middle"}},null,8,ae)):(0,i.Q3)("",!0)]))),128))])}var ie={name:"MusicList",props:{list:{type:Array,default:()=>[]}},data(){return{favoriteIds:JSON.parse(localStorage.getItem("favoriteMusicIds")||"[]"),audioMap:{}}},methods:{goDetail(e){this.$emit("go-detail",e)},isFavorite(e){return this.favoriteIds.includes(e)},toggleFavorite(e){const t=this.favoriteIds.indexOf(e);t>-1?this.favoriteIds.splice(t,1):this.favoriteIds.push(e),localStorage.setItem("favoriteMusicIds",JSON.stringify(this.favoriteIds)),this.$emit("favorite-change",this.favoriteIds)},async playMusic(e){const t=await j(e);console.log(t),t.data&&200===t.data.code&&t.data.data.url?(this.audioMap[e]=t.data.data.url,console.log("播放音乐URL:",this.audioMap[e])):this.audioMap[e]=""}}};const le=(0,o.A)(ie,[["render",se],["__scopeId","data-v-a54c936c"]]);var re=le,oe={name:"MusicSearch",components:{MusicList:re},data(){return{favoriteIds:JSON.parse(localStorage.getItem("favoriteMusicIds")||"[]"),searchType:"word",searchInput:"",results:[],resultById:null,loading:!1,error:""}},mounted(){this.isFavorite();const e=localStorage.getItem("musicSearchState");if(e)try{const t=JSON.parse(e);this.searchType=t.searchType||"word",this.searchInput=t.searchInput||"",this.results=t.results||[],this.resultById=t.resultById||null}catch(t){console.error("恢复搜索状态失败：",t)}},methods:{isFavorite(e){return this.favoriteIds.includes(e)},toggleFavorite(e){const t=this.favoriteIds.indexOf(e);t>-1?this.favoriteIds.splice(t,1):this.favoriteIds.push(e),localStorage.setItem("favoriteMusicIds",JSON.stringify(this.favoriteIds)),this.$emit("favorite-change",this.favoriteIds)},async handleSearchUnified(){if(!this.searchInput.trim())return this.error="word"===this.searchType?"请输入关键词":"请输入歌曲ID或链接",this.results=[],void(this.resultById=null);this.loading=!0,this.error="",this.results=[],this.resultById=null;try{if("word"===this.searchType){const e=await q(this.searchInput);e.data&&200===e.data.code?this.results=e.data.data||[]:(this.error=e.data.message||"搜索失败",this.results=[])}else{let e=this.searchInput.trim();const t=e.match(/id=(\d+)/);t&&(e=t[1]);const a=await j(e);console.log("ID/链接搜索结果:",a),a.data&&200===a.data.code&&a.data.data?this.resultById=a.data.data:(this.error=a.data.message||"未找到该ID对应的歌曲",this.resultById=null)}}catch(e){this.error="请求失败，请稍后重试",this.results=[],this.resultById=null}finally{this.loading=!1}},handleGoDetail(e){localStorage.setItem("musicSearchState",JSON.stringify({searchType:this.searchType,searchInput:this.searchInput,results:this.results,resultById:this.resultById})),console.log(this.searchType),this.$router.push({path:`/music/${e}`})}}};const ne=(0,o.A)(oe,[["render",T],["__scopeId","data-v-930ef734"]]);var ce=ne;const ue={key:0,class:"music-detail-card"},de=["src","alt"],ve={class:"music-detail-title"},he={class:"music-detail-meta"},fe={class:"music-detail-singer"},ye={class:"music-detail-album"},pe={class:"music-detail-quality"},me={class:"music-detail-size"},ge={class:"music-detail-select"},ke=["value"],Ie={class:"music-detail-audio"},be=["src"],Le={key:1,class:"music-detail-nourl"},Ce={key:0,class:"lyric-block"},Se={class:"lyric"},_e={key:1},Ee={key:2,class:"error"};function we(e,t,a,l,r,o){return r.music?((0,i.uX)(),(0,i.CE)("div",ue,[(0,i.Lk)("img",{src:r.music.cover,alt:r.music.song,class:"music-detail-cover"},null,8,de),(0,i.Lk)("h2",ve,(0,d.v_)(r.music.song),1),(0,i.Lk)("div",he,[(0,i.Lk)("div",fe,"歌手："+(0,d.v_)(r.music.singer),1),(0,i.Lk)("div",ye,"专辑："+(0,d.v_)(r.music.album),1),(0,i.Lk)("div",pe,"音质："+(0,d.v_)(r.music.quality),1),(0,i.Lk)("div",me,"大小："+(0,d.v_)(r.music.size||"未知"),1)]),(0,i.Lk)("div",ge,[t[2]||(t[2]=(0,i.Lk)("label",{class:"music-detail-label"},"音质：",-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedQuality=e),onChange:t[1]||(t[1]=(...e)=>o.fetchAndPlay&&o.fetchAndPlay(...e)),class:"music-detail-selectbox"},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.qualityOptions,e=>((0,i.uX)(),(0,i.CE)("option",{key:e.value,value:e.value},(0,d.v_)(e.label),9,ke))),128))],544),[[s.u1,r.selectedQuality]])]),(0,i.Lk)("div",Ie,[r.audioUrl?((0,i.uX)(),(0,i.CE)("audio",{key:0,src:r.audioUrl,controls:"",class:"music-detail-player"},null,8,be)):(0,i.Q3)("",!0),r.audioUrl||r.loading?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",Le,"请选择音质获取试听链接"))]),r.music.lyric?((0,i.uX)(),(0,i.CE)("div",Ce,[t[3]||(t[3]=(0,i.Lk)("h3",null,"歌词",-1)),(0,i.Lk)("pre",Se,(0,d.v_)(r.music.lyric),1)])):(0,i.Q3)("",!0)])):r.loading?((0,i.uX)(),(0,i.CE)("div",_e,"加载中...")):r.error?((0,i.uX)(),(0,i.CE)("div",Ee,(0,d.v_)(r.error),1)):(0,i.Q3)("",!0)}var Be={name:"MusicDetail",data(){return{music:null,loading:!1,error:"",selectedQuality:4,qualityOptions:[{value:1,label:"\t标准（64k）"},{value:2,label:"标准（128k）"},{value:3,label:"HQ极高（192k）"},{value:4,label:"\tHQ极高（320k）"},{value:5,label:"SQ无损"},{value:6,label:"高解析度无损（Hi-Res）"},{value:7,label:"\t高清臻音（Spatial Autio）"},{value:8,label:"\t沉浸环绕声（Surround Autio）"},{value:9,label:"超清母带（Master）"}],audioUrl:""}},async created(){await this.fetchAndPlay()},methods:{async fetchAndPlay(){const e=this.$route.params.id;if(e){this.loading=!0,this.audioUrl="";try{const t=await j(e,this.selectedQuality);console.log("音乐详情结果:",t),t.data&&200===t.data.code?(this.music=t.data.data,this.audioUrl=t.data.data.url||""):this.error=t.data?.message||"未找到该音质的播放链接"}catch(t){this.error="请求失败，请稍后重试"}finally{this.loading=!1}}else this.error="无效的歌曲ID"}},watch:{selectedQuality(){this.fetchAndPlay()}}};const Xe=(0,o.A)(Be,[["render",we],["__scopeId","data-v-566780a1"]]);var Oe=Xe;const Me={class:"favorite-list"},Fe={key:0,style:{color:"#888","margin-top":"30px"}};function Qe(e,t,a,s,l,r){const o=(0,i.g2)("FavoriteMusicList");return(0,i.uX)(),(0,i.CE)("div",Me,[t[0]||(t[0]=(0,i.Lk)("h2",null,"我喜欢的音乐",-1)),(0,i.bF)(o,{list:l.favoriteSongs,onRefresh:r.fetchFavorites},null,8,["list","onRefresh"]),l.favoriteSongs.length?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",Fe,"暂无喜欢的音乐"))])}a(8111),a(7588),a(1701);const Ue={class:"fav-music-list"},Ae=["src","alt"],De={class:"fav-info"},Pe={class:"fav-song"},xe={class:"fav-singer"},Te={class:"fav-album"},$e={class:"fav-quality"},Ne={class:"fav-audio-row"},je=["src","autoplay","onEnded","onPlay"],qe=["onClick"];function Je(e,t,a,s,l,r){return(0,i.uX)(),(0,i.CE)("ul",Ue,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.list,(e,t)=>((0,i.uX)(),(0,i.CE)("li",{key:e.url||e.id,class:"fav-music-item"},[(0,i.Lk)("img",{src:e.pic||e.cover,alt:e.name||e.song,class:"fav-cover"},null,8,Ae),(0,i.Lk)("div",De,[(0,i.Lk)("div",Pe,(0,d.v_)(e.name||e.song),1),(0,i.Lk)("div",xe,"歌手："+(0,d.v_)(e.ar_name||e.singer),1),(0,i.Lk)("div",Te,"专辑："+(0,d.v_)(e.al_name||e.album),1),(0,i.Lk)("div",$e,"音质："+(0,d.v_)(e.quality),1),(0,i.Lk)("div",Ne,[e.url?((0,i.uX)(),(0,i.CE)("audio",{key:0,src:e.url,controls:"",class:"fav-audio-player",ref_for:!0,ref:"audioRefs",autoplay:l.currentPlaying===t,onEnded:e=>r.playNext(t),onPlay:e=>l.currentPlaying=t},null,40,je)):(0,i.Q3)("",!0),(0,i.Lk)("button",{class:"unfav-btn",onClick:t=>r.removeFavorite(e.id)},"❤️",8,qe)])])]))),128))])}a(2489);var Re={name:"FavoriteMusicList",props:{list:{type:Array,default:()=>[]}},data(){return{levelOptions:[{value:"standard",label:"标准"},{value:"exhigh",label:"极高"},{value:"lossless",label:"无损"},{value:"hires",label:"Hi-Res"},{value:"jyeffect",label:"高清环绕"},{value:"sky",label:"沉浸环绕"},{value:"jymaster",label:"超清母带"}],audioLevels:{},audioUrls:{},currentPlaying:null}},methods:{async fetchAudio(e){const t=await j(e);console.log(t),t.data&&200===t.data.status&&t.data.url?this.audioUrls[e]=t.data.url:this.audioUrls[e]=""},playNext(e){e<this.list.length-1?(this.currentPlaying=e+1,this.$nextTick(()=>{const t=this.$refs.audioRefs[e+1];t&&t.play()})):this.currentPlaying=null},removeFavorite(e){let t=JSON.parse(localStorage.getItem("favoriteMusicIds")||"[]");t=t.filter(t=>t!==e),localStorage.setItem("favoriteMusicIds",JSON.stringify(t)),this.$emit("refresh")}}};const Ge=(0,o.A)(Re,[["render",Je],["__scopeId","data-v-5cd3decd"]]);var ze=Ge,He={name:"FavoriteList",components:{FavoriteMusicList:ze},data(){return{favoriteSongs:[]}},async created(){const e=JSON.parse(localStorage.getItem("favoriteMusicIds")||"[]");if(e.length){const t=await Promise.all(e.map(e=>j(e)));console.log("喜欢的音乐结果:",t);let a=[];t.forEach(e=>{e.data&&200===e.data.code&&(a=a.concat(e.data.data))}),this.favoriteSongs=a}this.fetchFavorites()},methods:{async fetchFavorites(){const e=JSON.parse(localStorage.getItem("favoriteMusicIds")||"[]");if(e.length){const t=await Promise.all(e.map(e=>j(e)));let a=[];t.forEach(e=>{e.data&&200===e.data.code&&(a=a.concat(e.data.data))}),this.favoriteSongs=a}else this.favoriteSongs=[]}}};const Ke=(0,o.A)(He,[["render",Qe],["__scopeId","data-v-7fc490f5"]]);var Ve=Ke;const We=[{path:"/",component:ce},{path:"/music/:id",component:Oe,props:!0},{path:"/favorite",component:Ve}],Ye=(0,u.aE)({history:(0,u.Bt)(),routes:We});var Ze=Ye;(0,s.Ef)(c).use(Ze).mount("#app")}},t={};function a(s){var i=t[s];if(void 0!==i)return i.exports;var l=t[s]={exports:{}};return e[s].call(l.exports,l,l.exports,a),l.exports}a.m=e,function(){var e=[];a.O=function(t,s,i,l){if(!s){var r=1/0;for(u=0;u<e.length;u++){s=e[u][0],i=e[u][1],l=e[u][2];for(var o=!0,n=0;n<s.length;n++)(!1&l||r>=l)&&Object.keys(a.O).every(function(e){return a.O[e](s[n])})?s.splice(n--,1):(o=!1,l<r&&(r=l));if(o){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[s,i,l]}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,l,r=s[0],o=s[1],n=s[2],c=0;if(r.some(function(t){return 0!==e[t]})){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(n)var u=n(a)}for(t&&t(s);c<r.length;c++)l=r[c],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(u)},s=self["webpackChunkmusic_web"]=self["webpackChunkmusic_web"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],function(){return a(5661)});s=a.O(s)})();
//# sourceMappingURL=app.7cfb9075.js.map