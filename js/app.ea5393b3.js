(function(){"use strict";var e={1614:function(e,a,l){var t=l(3751),s=l(810),i=l(641),n=l(953),o=(l(8111),l(2489),l(7642),l(8004),l(3853),l(5876),l(2475),l(5024),l(1698),l(4335));const u=o.A.create({baseURL:"https://api.vkeys.cn/v2/music/netease",timeout:1e4});function r(e,a=4){return u.get("",{params:{id:e,quality:a}})}function c(e){return u.get("",{params:{word:e}})}function v(e){return u.get("/lyric",{params:{id:e}})}const d=(0,s.nY)("playerStore",{state:()=>({url:"",song:"",singer:"",cover:"",id:null,playIndex:0,playList:[],playMode:"order",playedSet:new Set,volume:1,isPlaying:!1,currentTime:0}),actions:{async playByIndex(e){if(!this.playList[e])return;const a=this.playList[e],l=await this.retryFetchMusicUrl(a.id);l&&(this.url=l,this.song=a.song||a.name,this.singer=a.singer||a.ar_name,this.cover=a.cover||a.pic,this.id=a.id,this.playIndex=e)},async retryFetchMusicUrl(e,a=8){for(let t=0;t<a;t++){try{const a=await r(e);if(200===a.data?.code&&a.data.data?.url)return a.data.data.url}catch(l){console.warn(`重试 ${t+1}/${a} 失败`)}await new Promise(e=>setTimeout(e,500))}return null},async playNext(){if("random"===this.playMode)await this.playRandom();else{const e=this.playIndex+1;e<this.playList.length&&await this.playByIndex(e)}},async playPrev(){const e=this.playIndex-1;e>=0&&await this.playByIndex(e)},async playRandom(){if(0===this.playList.length)return;this.playedSet.add(this.id);const e=this.playList.filter(e=>!this.playedSet.has(e.id));let a;e.length>0?a=e[Math.floor(Math.random()*e.length)]:(this.playedSet.clear(),a=this.playList[Math.floor(Math.random()*this.playList.length)]);const l=this.playList.findIndex(e=>e.id===a.id);await this.playByIndex(l)},togglePlayMode(){const e=["order","random","single"],a=e.indexOf(this.playMode);this.playMode=e[(a+1)%e.length],this.playedSet.clear()},setPlayList(e,a=0){this.playList=e,this.playIndex=a},updateCurrentTime(e){this.currentTime=e}}});l(4114);var p=l(33),y=l(5220);const h={class:"global-audio-player"},m={class:"progress-bar"},f={class:"player-content"},k=["src"],g={class:"player-meta"},L={class:"player-title"},b={class:"player-artist"},C={class:"center-controls"},_=["disabled"],w=["disabled"],M={key:0,viewBox:"0 0 24 24",class:"icon"},I={key:1,viewBox:"0 0 24 24",class:"icon"},R=["disabled"],S=["title"],E={key:0,viewBox:"0 0 24 24",class:"icon icon-small"},x={key:1,viewBox:"0 0 24 24",class:"icon icon-small"},X={key:2,viewBox:"0 0 24 24",class:"icon icon-small"},K={class:"volume-control"},B={key:0,viewBox:"0 0 24 24",class:"icon icon-small"},F={key:1,viewBox:"0 0 24 24",class:"icon icon-small"},P={key:2,viewBox:"0 0 24 24",class:"icon icon-small"},z={class:"volume-slider-wrapper"},O=["src"];var T={__name:"GlobalAudioPlayer",props:{src:String,title:String,artist:String,cover:String,musicId:[String,Number],playMode:{type:String,default:"order"}},emits:["prev","next","togglePlayMode","play","pause","timeupdate","play-random"],setup(e,{emit:a}){const l=e,s=a,o=(0,n.KR)(null),u=(0,n.KR)(!0),r=(0,n.KR)(!1),c=(0,n.KR)(0),v=(0,n.KR)(0),d=(0,n.KR)(1),T=(0,n.KR)(100),V=(0,n.KR)(1),q=(0,n.KR)(!1),A=(0,n.KR)(!1),$=(0,n.KR)(!1),N=(0,n.KR)(new Set),H=(0,n.KR)(l.playMode),J=(0,n.KR)(0),{proxy:Q}=(0,i.nI)(),j=(0,y.rd)(),W=(0,i.EW)(()=>v.value?c.value/v.value*100:0),U=(0,i.EW)(()=>({order:"顺序播放",random:"随机播放",single:"单曲循环"}[H.value]));function D(e){e.preventDefault(),v.value&&(q.value=!0,A.value=r.value,r.value&&o.value&&o.value.pause(),J.value=c.value,Z(e),window.addEventListener("mousemove",Y),window.addEventListener("mouseup",G))}function Y(e){q.value&&(Q._rafPending||(Q._rafPending=!0,requestAnimationFrame(()=>{Z(e),Q._rafPending=!1})))}function G(e){q.value&&(q.value=!1,Z(e),o.value&&(o.value.currentTime=J.value),A.value&&o.value&&o.value.play(),window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",G))}function Z(e){const a=Q.$el.querySelector(".top-progress-bar");if(!a||!v.value)return;const l=a.getBoundingClientRect(),t=Math.max(0,Math.min(e.clientX-l.left,l.width)),s=t/l.width,i=s*v.value;J.value=i;const n=Q.$el.querySelector(".progress-bar-fill");n&&(n.style.width=100*s+"%");const o=Q.$el.querySelector(".progress-handle");o&&(o.style.left=100*s+"%")}function ee(){o.value&&(r.value?o.value.pause():o.value.play())}function ae(){const e=H.value;if(r.value=!1,"single"===e)o.value&&(o.value.currentTime=0,o.value.play());else if("order"===e)s("next");else if("random"===e){const e=Q.$parent;if(!e?.playlist||!Array.isArray(e.playlist))return void s("next");const a=e.playlist;if(0===a.length)return;N.value.add(l.musicId);const t=a.filter(e=>!N.value.has(e.id));let i;t.length>0?i=t[Math.floor(Math.random()*t.length)]:(N.value.clear(),i=a[Math.floor(Math.random()*a.length)]),s("play-random",i)}}function le(){r.value=!0,s("play")}function te(){r.value=!1,s("pause")}function se(){o.value&&!q.value&&(c.value=o.value.currentTime,s("timeupdate",c.value))}function ie(){o.value&&(v.value=o.value.duration)}function ne(){o.value&&(d.value=T.value/100,o.value.volume=d.value)}function oe(){o.value&&(d.value>0?(V.value=d.value,d.value=0,T.value=0,o.value.volume=0):(d.value=V.value,T.value=100*V.value,o.value.volume=V.value))}function ue(){l.musicId&&j.push(`/music/${l.musicId}`)}function re(){u.value=!1,o.value&&o.value.pause()}return(0,i.wB)(()=>l.playMode,e=>{H.value=e}),(0,i.wB)(()=>l.src,e=>{u.value=!!e,e&&(0,i.dY)(()=>{o.value&&o.value.play()})}),(0,i.sV)(()=>{o.value&&(o.value.volume=d.value)}),(a,l)=>(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",h,[(0,i.Lk)("div",{class:"top-progress-bar",onMousedown:D,onMouseenter:l[0]||(l[0]=e=>$.value=!0),onMouseleave:l[1]||(l[1]=e=>$.value=!1)},[(0,i.Lk)("div",m,[(0,i.Lk)("div",{class:"progress-bar-fill",style:(0,p.Tr)({width:W.value+"%"})},null,4),(0,i.Lk)("div",{class:"progress-handle",style:(0,p.Tr)({left:W.value+"%"})},null,4)])],32),(0,i.Lk)("div",f,[(0,i.Lk)("div",{class:(0,p.C4)(["player-info",{clickable:e.musicId}]),onClick:ue},[e.cover?((0,i.uX)(),(0,i.CE)("img",{key:0,src:e.cover,class:"player-cover"},null,8,k)):(0,i.Q3)("",!0),(0,i.Lk)("div",g,[(0,i.Lk)("div",L,(0,p.v_)(e.title||"未选择歌曲"),1),(0,i.Lk)("div",b,(0,p.v_)(e.artist),1)])],2),(0,i.Lk)("div",C,[(0,i.Lk)("button",{class:"control-btn small-btn",onClick:l[2]||(l[2]=e=>a.$emit("prev")),disabled:!e.src},[...l[6]||(l[6]=[(0,i.Lk)("svg",{viewBox:"0 0 24 24",class:"icon"},[(0,i.Lk)("path",{d:"M6 12l10-7v14L6 12zm-2 7h2V5H4v14z",fill:"currentColor"})],-1)])],8,_),(0,i.Lk)("button",{class:"control-btn play-pause-btn",onClick:ee,disabled:!e.src},[r.value?((0,i.uX)(),(0,i.CE)("svg",I,[...l[8]||(l[8]=[(0,i.Lk)("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z",fill:"currentColor"},null,-1)])])):((0,i.uX)(),(0,i.CE)("svg",M,[...l[7]||(l[7]=[(0,i.Lk)("path",{d:"M8 5v14l11-7z",fill:"currentColor"},null,-1)])]))],8,w),(0,i.Lk)("button",{class:"control-btn small-btn",onClick:l[3]||(l[3]=e=>a.$emit("next")),disabled:!e.src},[...l[9]||(l[9]=[(0,i.Lk)("svg",{viewBox:"0 0 24 24",class:"icon"},[(0,i.Lk)("path",{d:"M18 12L8 19V5l10 7zm2-7h-2v14h2V5z",fill:"currentColor"})],-1)])],8,R)]),(0,i.Lk)("button",{class:"control-btn mode-btn",onClick:l[4]||(l[4]=e=>a.$emit("togglePlayMode")),title:U.value},["order"===H.value?((0,i.uX)(),(0,i.CE)("svg",E,[...l[10]||(l[10]=[(0,i.Lk)("path",{d:"M3 12l7-7v14l-7-7zm11 0l7-7v14l-7-7z",fill:"currentColor"},null,-1)])])):"random"===H.value?((0,i.uX)(),(0,i.CE)("svg",x,[...l[11]||(l[11]=[(0,i.Lk)("path",{d:"M17 1l4 4-4 4V6h-2.59l-4 4H9l4-4H17V1zM3 9l4 4-4 4V9zm8 6l4-4H17v3l4-4-4-4v3h-2.59l-4 4H11z",fill:"currentColor"},null,-1)])])):((0,i.uX)(),(0,i.CE)("svg",X,[...l[12]||(l[12]=[(0,i.Lk)("path",{d:"M7 7v2h6v2H5V7h2zm10 0h2v10h-2v-2h-6v-2h6V7z",fill:"currentColor"},null,-1)])]))],8,S),(0,i.Lk)("div",K,[(0,i.Lk)("button",{class:"control-btn volume-btn",onClick:oe},[d.value>.5?((0,i.uX)(),(0,i.CE)("svg",B,[...l[13]||(l[13]=[(0,i.Lk)("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z",fill:"currentColor"},null,-1)])])):d.value>0?((0,i.uX)(),(0,i.CE)("svg",F,[...l[14]||(l[14]=[(0,i.Lk)("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z",fill:"currentColor"},null,-1)])])):((0,i.uX)(),(0,i.CE)("svg",P,[...l[15]||(l[15]=[(0,i.Lk)("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z",fill:"currentColor"},null,-1)])]))]),(0,i.Lk)("div",z,[(0,i.bo)((0,i.Lk)("input",{type:"range",class:"volume-slider",min:"0",max:"100","onUpdate:modelValue":l[5]||(l[5]=e=>T.value=e),onInput:ne},null,544),[[t.Jo,T.value]])])]),(0,i.Lk)("button",{class:"player-close",onClick:re},"✖")]),(0,i.Lk)("audio",{autoplay:"",ref_key:"audio",ref:o,src:e.src,onEnded:ae,onPlay:le,onPause:te,onTimeupdate:se,onLoadedmetadata:ie},null,40,O)],512)),[[t.aG,u.value]])}},V=l(6262);const q=(0,V.A)(T,[["__scopeId","data-v-49ccd56e"]]);var A=q;const $={id:"app-layout"};var N={__name:"App",setup(e){const a=d();return(e,l)=>{const t=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",$,[(0,i.bF)(t),(0,n.R1)(a).url?((0,i.uX)(),(0,i.Wv)(A,{key:0,src:(0,n.R1)(a).url,title:(0,n.R1)(a).song,artist:(0,n.R1)(a).singer,cover:(0,n.R1)(a).cover,musicId:(0,n.R1)(a).id,playMode:(0,n.R1)(a).playMode,onPrev:l[0]||(l[0]=e=>(0,n.R1)(a).playPrev()),onNext:l[1]||(l[1]=e=>(0,n.R1)(a).playNext()),onTogglePlayMode:l[2]||(l[2]=e=>(0,n.R1)(a).togglePlayMode()),onTimeupdate:(0,n.R1)(a).updateCurrentTime},null,8,["src","title","artist","cover","musicId","playMode","onTimeupdate"])):(0,i.Q3)("",!0)])}}};const H=N;var J=H;const Q=(0,s.nY)("favorites",{state:()=>({ids:JSON.parse(localStorage.getItem("favoriteMusicIds")||"[]"),cache:JSON.parse(localStorage.getItem("favoriteMusicCache")||"[]")}),getters:{isFavorite:e=>a=>e.ids.includes(a),favoriteCount:e=>e.ids.length},actions:{toggle(e){const a=e.id,l=this.ids.indexOf(a);l>-1?(this.ids.splice(l,1),this.cache=this.cache.filter(e=>e.id!==a)):(this.ids.unshift(a),this.cache.unshift({id:a,song:e.song||e.name,singer:e.singer||e.ar_name,cover:e.cover||e.pic,album:e.album||e.al_name,quality:e.quality})),this.persist()},removeById(e){this.ids=this.ids.filter(a=>a!==e),this.cache=this.cache.filter(a=>a.id!==e),this.persist()},persist(){localStorage.setItem("favoriteMusicIds",JSON.stringify(this.ids)),localStorage.setItem("favoriteMusicCache",JSON.stringify(this.cache))},refreshFromStorage(){this.ids=JSON.parse(localStorage.getItem("favoriteMusicIds")||"[]"),this.cache=JSON.parse(localStorage.getItem("favoriteMusicCache")||"[]")}}}),j={class:"music-list"},W=["src","onClick"],U={class:"music-info"},D=["onClick"],Y={class:"music-singer"},G={class:"music-album"},Z={class:"music-quality"},ee=["onClick"],ae=["onClick"];var le={__name:"MusicList",props:{list:{type:Array,default:()=>[]}},emits:["go-detail"],setup(e,{emit:a}){const l=e,t=a,s=d(),o=Q(),u=async(e,a)=>{console.log("播放了",a),s.setPlayList(l.list,a),await s.playByIndex(a)},r=e=>{s.setPlayList(l.list),t("go-detail",e)},c=e=>{o.toggle(e)};return(a,l)=>((0,i.uX)(),(0,i.CE)("div",j,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.list,(e,a)=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"music-item"},[(0,i.Lk)("img",{src:e.cover||e.pic,class:"music-cover",onClick:a=>r(e.id)},null,8,W),(0,i.Lk)("div",U,[(0,i.Lk)("div",{class:"music-song",onClick:a=>r(e.id)},(0,p.v_)(e.song||e.name),9,D),(0,i.Lk)("div",Y,(0,p.v_)(e.singer||e.ar_name),1),(0,i.Lk)("div",G,(0,p.v_)(e.album||e.al_name),1),(0,i.Lk)("div",Z,(0,p.v_)(e.quality),1)]),(0,i.Lk)("button",{class:"play-btn",onClick:l=>u(e,a)}," ▶️ 播放 ",8,ee),(0,i.Lk)("button",{class:(0,p.C4)(["fav-btn",{liked:(0,n.R1)(o).isFavorite(e.id)}]),onClick:a=>c(e)},(0,p.v_)((0,n.R1)(o).isFavorite(e.id)?"❤️ 已收藏":"🤍 收藏"),11,ae)]))),128))]))}};const te=(0,V.A)(le,[["__scopeId","data-v-72fad54c"]]);var se=te;const ie={id:"music-search"},ne={class:"sidebar"},oe={class:"main-content"},ue={class:"search-bar"},re=["placeholder"],ce={key:0,class:"error-message"},ve={key:1,class:"results-container"},de={key:2,class:"results-container"},pe={class:"music-detail-card"},ye=["src"],he={class:"detail-info"};var me={__name:"MusicSearch",setup(e){const a=(0,y.rd)(),l=Q(),s=(0,n.KR)("word"),o=(0,n.KR)(""),u=(0,n.KR)([]),v=(0,n.KR)(null),d=(0,n.KR)(!1),h=(0,n.KR)(""),m=async()=>{if(o.value.trim()){d.value=!0,h.value="",u.value=[],v.value=null;try{if("word"===s.value){const e=await c(o.value);e.data&&200===e.data.code?(u.value=e.data.data||[],localStorage.setItem("musicSearchState",JSON.stringify({searchType:s.value,searchInput:o.value,results:u.value}))):h.value="搜索失败，请重试"}else if("id"===s.value){let e=o.value.trim();const a=e.match(/id=(\d+)/);a&&(e=a[1]);const l=await r(e);l.data&&200===l.data.code?(v.value=l.data.data,localStorage.setItem("musicSearchState",JSON.stringify({searchType:s.value,searchInput:o.value,resultById:v.value}))):h.value="未找到该歌曲"}}catch(e){console.error(e),h.value="网络错误，请重试"}finally{d.value=!1}}else h.value="请输入搜索内容"},f=e=>{a.push({path:`/music/${e}`})};return(0,i.sV)(()=>{const e=localStorage.getItem("musicSearchState");if(e)try{const a=JSON.parse(e);s.value=a.searchType||"word",o.value=a.searchInput||"",u.value=a.results||[],v.value=a.resultById||null}catch(a){console.warn("恢复搜索状态失败",a)}}),(e,a)=>{const r=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",ie,[(0,i.Lk)("div",ne,[a[5]||(a[5]=(0,i.Lk)("h2",{class:"sidebar-title"},"🎵 音乐世界",-1)),(0,i.bF)(r,{to:"/",class:"sidebar-btn"},{default:(0,i.k6)(()=>[...a[3]||(a[3]=[(0,i.eW)("🔍 搜索音乐",-1)])]),_:1}),(0,i.bF)(r,{to:"/favorites",class:"sidebar-btn"},{default:(0,i.k6)(()=>[...a[4]||(a[4]=[(0,i.eW)("❤️ 喜欢的音乐",-1)])]),_:1})]),(0,i.Lk)("div",oe,[(0,i.Lk)("div",ue,[(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),class:"search-type-select"},[...a[6]||(a[6]=[(0,i.Lk)("option",{value:"word"},"按歌曲名/歌手",-1),(0,i.Lk)("option",{value:"id"},"按歌曲ID",-1)])],512),[[t.u1,s.value]]),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e),type:"text",class:"search-input",placeholder:"word"===s.value?"输入歌曲名或歌手...":"输入歌曲ID或链接...",onKeyup:(0,t.jR)(m,["enter"])},null,40,re),[[t.Jo,o.value]]),(0,i.Lk)("button",{onClick:m,class:"search-btn"},(0,p.v_)(d.value?"搜索中...":"搜索"),1)]),h.value?((0,i.uX)(),(0,i.CE)("div",ce,(0,p.v_)(h.value),1)):(0,i.Q3)("",!0),u.value.length>0?((0,i.uX)(),(0,i.CE)("div",ve,[a[7]||(a[7]=(0,i.Lk)("h2",{style:{margin:"20px 0"}},"搜索结果：",-1)),(0,i.bF)(se,{list:u.value,onGoDetail:f},null,8,["list"])])):(0,i.Q3)("",!0),v.value?((0,i.uX)(),(0,i.CE)("div",de,[a[8]||(a[8]=(0,i.Lk)("h2",{style:{margin:"20px 0"}},"歌曲详情：",-1)),(0,i.Lk)("div",pe,[(0,i.Lk)("img",{src:v.value.cover,class:"detail-cover"},null,8,ye),(0,i.Lk)("div",he,[(0,i.Lk)("h3",null,(0,p.v_)(v.value.song),1),(0,i.Lk)("p",null,"歌手："+(0,p.v_)(v.value.singer),1),(0,i.Lk)("p",null,"专辑："+(0,p.v_)(v.value.album),1),(0,i.Lk)("p",null,"音质："+(0,p.v_)(v.value.quality),1),(0,i.Lk)("button",{class:(0,p.C4)(["fav-btn",{liked:(0,n.R1)(l).isFavorite(v.value.id)}]),onClick:a[2]||(a[2]=e=>(0,n.R1)(l).toggle(v.value))},(0,p.v_)((0,n.R1)(l).isFavorite(v.value.id)?"❤️ 已收藏":"🤍 收藏"),3)])])])):(0,i.Q3)("",!0)])])}}};const fe=(0,V.A)(me,[["__scopeId","data-v-2c8a7cf9"]]);var ke=fe;l(7588);const ge={class:"music-detail"},Le={class:"sidebar"},be={class:"main-content"},Ce={key:0,class:"loading"},_e={key:1,class:"error"},we={key:2,class:"detail-content two-columns"},Me={class:"left-panel"},Ie={class:"cover-section"},Re=["src"],Se={class:"song-title"},Ee={class:"info-box"},xe={class:"sub"},Xe={class:"sub"},Ke={class:"sub"},Be={class:"right-panel"},Fe={key:0,class:"no-lyric"},Pe={key:1,class:"lyric-list"},ze={class:"controls-bar"},Oe={class:"quality-selector inline"},Te=["value"],Ve=["disabled"],qe={key:0,viewBox:"0 0 24 24",class:"play-icon"},Ae={key:1,class:"loading-spinner"};var $e={__name:"MusicDetail",setup(e){const a=(0,y.lq)(),{proxy:l}=(0,i.nI)(),s=d(),o=(0,n.KR)(null),u=(0,n.KR)(!1),c=(0,n.KR)(""),h=(0,n.KR)(4),m=[{value:1,label:"标准"},{value:2,label:"较高"},{value:3,label:"极高"},{value:4,label:"无损"}],f=(0,n.KR)(""),k=(0,n.KR)(""),g=(0,n.KR)([]),L=(0,n.KR)(0),b=(0,n.KR)(!1);async function C(e){u.value=!0,c.value="",o.value=null,f.value="";try{const a=await r(e);console.log(a),a.data&&200===a.data.code?(o.value=a.data.data,console.log(o.value),f.value=a.data.data.url||""):c.value="未找到该歌曲"}catch(a){console.error(a),c.value="加载失败"}finally{u.value=!1}}function _(){o.value&&f.value?(s.url=f.value,s.song=o.value.song,s.singer=o.value.singer,s.cover=o.value.cover,s.id=o.value.id):c.value="音乐数据未加载完成"}async function w(e){try{const a=await v(e);a.data&&200===a.data.code&&(k.value=a.data.data.lrc,g.value=R(k.value))}catch(a){console.warn("歌词加载失败",a)}}function M(e){if(!g.value.length)return;let a=0;for(let l=0;l<g.value.length;l++){if(!(e>=g.value[l].time))break;a=l}L.value=a,S()}async function I(){const e=a.params.id;e&&(await C(e),await w(e))}function R(e){if(!e)return[];const a=e.split("\n"),l=[],t=/\[(\d{2}):(\d{2})\.(\d{2,3})\]/g;return a.forEach(e=>{const a=[...e.matchAll(t)];if(a.length>0){const s=e.replace(t,"").trim();a.forEach(e=>{const a=parseInt(e[1]),t=parseInt(e[2]),i=parseInt(e[3].padEnd(3,"0")),n=60*a+t+i/1e3;l.push({time:n,text:s})})}}),l.sort((e,a)=>e.time-a.time)}function S(){(0,i.dY)(()=>{const e=l.$el.querySelector(".lyric-container"),a=l.$el.querySelector(".lyric-line.active");if(e&&a&&!b.value){const l=e.clientHeight,t=a.offsetTop,s=a.clientHeight,i=t-l/2+s/2;e.scrollTo({top:i,behavior:"smooth"})}})}return(0,i.wB)(()=>a.params.id,e=>{e&&I()}),(0,i.wB)(()=>s.currentTime,e=>{s.id===o.value?.id&&M(e)}),(0,i.sV)(()=>{I()}),(0,y.V6)((e,a,l)=>{l(),e.params.id!==a.params.id&&I()}),(e,a)=>{const l=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",ge,[(0,i.Lk)("div",Le,[a[5]||(a[5]=(0,i.Lk)("h2",{class:"sidebar-title"},"🎵 音乐世界",-1)),(0,i.bF)(l,{to:"/",class:"sidebar-btn"},{default:(0,i.k6)(()=>[...a[3]||(a[3]=[(0,i.eW)("🔍 搜索音乐",-1)])]),_:1}),(0,i.bF)(l,{to:"/favorites",class:"sidebar-btn"},{default:(0,i.k6)(()=>[...a[4]||(a[4]=[(0,i.eW)("❤️ 喜欢的音乐",-1)])]),_:1})]),(0,i.Lk)("div",be,[u.value?((0,i.uX)(),(0,i.CE)("div",Ce,"加载中...")):(0,i.Q3)("",!0),c.value?((0,i.uX)(),(0,i.CE)("div",_e,(0,p.v_)(c.value),1)):(0,i.Q3)("",!0),o.value?((0,i.uX)(),(0,i.CE)("div",we,[(0,i.Lk)("div",Me,[(0,i.Lk)("div",Ie,[(0,i.Lk)("img",{src:o.value.pic||o.value.cover,class:"cover-large"},null,8,Re),(0,i.Lk)("h1",Se,(0,p.v_)(o.value.name),1)]),(0,i.Lk)("div",Ee,[(0,i.Lk)("p",xe,"歌手："+(0,p.v_)(o.value.ar_name||o.value.singer),1),(0,i.Lk)("p",Xe,"专辑："+(0,p.v_)(o.value.al_name||o.value.album),1),(0,i.Lk)("p",Ke,"音质："+(0,p.v_)(o.value.quality),1)])]),(0,i.Lk)("div",Be,[(0,i.Lk)("div",{class:"lyric-container",onMouseenter:a[0]||(a[0]=e=>b.value=!0),onMouseleave:a[1]||(a[1]=e=>b.value=!1)},[a[6]||(a[6]=(0,i.Lk)("h2",null,"🎤 歌词",-1)),0===g.value.length?((0,i.uX)(),(0,i.CE)("div",Fe," 暂无歌词 ")):((0,i.uX)(),(0,i.CE)("div",Pe,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(g.value,(e,a)=>((0,i.uX)(),(0,i.CE)("div",{key:a,class:(0,p.C4)(["lyric-line",{active:a===L.value}])},(0,p.v_)(e.text),3))),128))]))],32),(0,i.Lk)("div",ze,[(0,i.Lk)("div",Oe,[a[7]||(a[7]=(0,i.Lk)("label",null,"选择音质：",-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>h.value=e)},[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(m,e=>(0,i.Lk)("option",{key:e.value,value:e.value},(0,p.v_)(e.label),9,Te)),64))],512),[[t.u1,h.value]])]),(0,i.Lk)("button",{class:"play-button",onClick:_,disabled:u.value||!f.value},[u.value?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("svg",qe,[...a[8]||(a[8]=[(0,i.Lk)("path",{d:"M8 5v14l11-7z",fill:"currentColor"},null,-1)])])),u.value?((0,i.uX)(),(0,i.CE)("span",Ae,"⏳")):(0,i.Q3)("",!0),(0,i.Lk)("span",null,(0,p.v_)(u.value?"加载中...":"播放音乐"),1)],8,Ve)])])])):(0,i.Q3)("",!0)])])}}};const Ne=(0,V.A)($e,[["__scopeId","data-v-0a5a2d6c"]]);var He=Ne;const Je={class:"fav-music-list"},Qe=["src","onClick"],je={class:"fav-info"},We=["onClick"],Ue={class:"fav-singer"},De={class:"fav-album"},Ye={class:"fav-quality"},Ge=["onClick"],Ze=["onClick"];var ea={__name:"FavoriteMusicList",props:{list:{type:Array,default:()=>[]}},setup(e){const a=e,l=(0,y.rd)(),t=d(),s=Q(),n=(e,l)=>{t.setPlayList(a.list,l),t.playByIndex(l)},o=e=>{s.removeById(e)},u=e=>{t.setPlayList(a.list),l.push({path:`/music/${e}`})};return(a,l)=>((0,i.uX)(),(0,i.CE)("div",Je,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.list,(e,a)=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"fav-music-item"},[(0,i.Lk)("img",{src:e.cover,class:"fav-cover",onClick:a=>u(e.id)},null,8,Qe),(0,i.Lk)("div",je,[(0,i.Lk)("div",{class:"fav-song",onClick:a=>u(e.id)},(0,p.v_)(e.song),9,We),(0,i.Lk)("div",Ue,(0,p.v_)(e.singer),1),(0,i.Lk)("div",De,(0,p.v_)(e.album),1),(0,i.Lk)("div",Ye,(0,p.v_)(e.quality),1)]),(0,i.Lk)("button",{class:"play-btn",onClick:l=>n(e,a)}," ▶️ 播放 ",8,Ge),(0,i.Lk)("button",{class:"unfav-btn",onClick:a=>o(e.id)}," 💔 取消收藏 ",8,Ze)]))),128))]))}};const aa=(0,V.A)(ea,[["__scopeId","data-v-4113bed6"]]);var la=aa;const ta={class:"favorite-list"},sa={class:"sidebar"},ia={class:"main-content"},na={key:0,class:"empty"};var oa={__name:"FavoriteList",setup(e){const a=Q();return(0,i.sV)(()=>{a.refreshFromStorage()}),(e,l)=>{const t=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",ta,[(0,i.Lk)("div",sa,[l[2]||(l[2]=(0,i.Lk)("h2",{class:"sidebar-title"},"🎵 音乐世界",-1)),(0,i.bF)(t,{to:"/",class:"sidebar-btn"},{default:(0,i.k6)(()=>[...l[0]||(l[0]=[(0,i.eW)("🔍 搜索音乐",-1)])]),_:1}),(0,i.bF)(t,{to:"/favorites",class:"sidebar-btn"},{default:(0,i.k6)(()=>[...l[1]||(l[1]=[(0,i.eW)("❤️ 喜欢的音乐",-1)])]),_:1})]),(0,i.Lk)("div",ia,[(0,i.Lk)("h1",null,"❤️ 我喜欢的音乐 ("+(0,p.v_)((0,n.R1)(a).favoriteCount)+")",1),0===(0,n.R1)(a).cache.length?((0,i.uX)(),(0,i.CE)("div",na," 暂无收藏，快去搜索页面添加喜欢的音乐吧！ ")):(0,i.Q3)("",!0),(0,i.bF)(la,{list:(0,n.R1)(a).cache},null,8,["list"])])])}}};const ua=(0,V.A)(oa,[["__scopeId","data-v-b157e934"]]);var ra=ua;const ca=[{path:"/",component:ke},{path:"/music/:id",component:He,props:!0},{path:"/favorites",component:ra}],va=(0,y.aE)({history:(0,y.Bt)(),routes:ca});var da=va,pa=l(7693);l(2241);const ya=(0,t.Ef)(J),ha=(0,s.Ey)();ya.use(ha),ya.use(da),ya.use(pa.I),ya.mount("#app")}},a={};function l(t){var s=a[t];if(void 0!==s)return s.exports;var i=a[t]={exports:{}};return e[t].call(i.exports,i,i.exports,l),i.exports}l.m=e,function(){var e=[];l.O=function(a,t,s,i){if(!t){var n=1/0;for(c=0;c<e.length;c++){t=e[c][0],s=e[c][1],i=e[c][2];for(var o=!0,u=0;u<t.length;u++)(!1&i||n>=i)&&Object.keys(l.O).every(function(e){return l.O[e](t[u])})?t.splice(u--,1):(o=!1,i<n&&(n=i));if(o){e.splice(c--,1);var r=s();void 0!==r&&(a=r)}}return a}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[t,s,i]}}(),function(){l.d=function(e,a){for(var t in a)l.o(a,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(a){return 0===e[a]};var a=function(a,t){var s,i,n=t[0],o=t[1],u=t[2],r=0;if(n.some(function(a){return 0!==e[a]})){for(s in o)l.o(o,s)&&(l.m[s]=o[s]);if(u)var c=u(l)}for(a&&a(t);r<n.length;r++)i=n[r],l.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return l.O(c)},t=self["webpackChunkmusic_web"]=self["webpackChunkmusic_web"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))}();var t=l.O(void 0,[504],function(){return l(1614)});t=l.O(t)})();
//# sourceMappingURL=app.ea5393b3.js.map